---
title: "Activity Monitoring Device Output Data Statistics"
output: html_document
---

The purpose of this assignment is to analyze the data of the output data generated by an Activity Monitorning device like [Fitbit](http://www.fitbit.com/) or [Nike Fuelband](http://www.nike.com/us/en_us/c/nikeplus-fuelband). A simple statistics will be calculated.

##Loading and preprocessing the data

The data is archived into activity.xip file. The below code restores the data and loads the unarchived activity.csv file into a data.table object.

```{r}
unzip('activity.zip', overwrite=TRUE)
activity <- read.csv('activity.csv')
library(data.table)
activity <- as.data.table(activity)
```

##Calculating the mean total number of steps taken per day

The data.table object is subset per day in order to calculate the mean and median of the total steps taken. The histogram is also constructed using the base plotting package.

```{r}
dailySubset <- activity[, sum(steps, na.rm = TRUE), by = date]
setnames(dailySubset, 'V1', 'total_steps')
hist(dailySubset[,total_steps], breaks = 9, main = 'Histogram of daily total steps', xlab = '# of total steps', col = 'darkolivegreen4')
totStepsMean <- mean(dailySubset[,total_steps])
totStepsMedian <- median(dailySubset[,total_steps])
```

Hence the mean of the daily total steps taken is equal to `r round(totStepsMean,0)` and the median to `r totStepsMedian`.  

##Calculating the average daily activity pattern

The same data.table object activity is taken and subset (grouped) by interval. The arithmetic mean is calculated separately for each interval. The result is assigned to dailyIntervalSubset object.

```{r}
dailyIntervalSubset <- activity[, mean(steps, na.rm = TRUE), by = interval]
setnames(dailyIntervalSubset, 'V1', 'period_average')
```

The below graph is plotted to ilistrate the daily pattern in the user's activity.

```{r}
with(dailyIntervalSubset, plot(interval, period_average, type = 'l', col = 'darkolivegreen4', main = 'Interval average for the entire period', xlab = 'Interval', ylab = 'Average # of steps'))
```

```{r}
averageMax = max(dailyIntervalSubset[, period_average])
averageMaxInterval = dailyIntervalSubset[, interval][which.max(dailyIntervalSubset[, period_average])]
```

The maximum number of `r round(averageMax, 0)` steps is recorded for the `r averageMaxInterval` minutes interval.

##Inputing missing values.

The total number of missing (NA) values is calculated below:

```{r}
missingVals <- sum(rowSums(is.na(activity)))
```

The data set contains `r missingVals` rows with NA values. The missing values for number of steps per interval have been replaced by the interval average (averaged on entire period) values.

```{r}
index <- which(is.na(activity)[,1])
dataTemplate <- data.table()
for(i in 1:dim(dailySubset)[1]){
    dataTemplate <- rbind(dataTemplate, dailyIntervalSubset)
}
activityMod <- copy(activity)
activityMod[, 'steps'][index] <- dataTemplate[, period_average][index]
```

The histogram of the new data set has been plotted below to check whether there would be any differences between the original one with NA values.

```{r}
activityMod[, 'steps'] <- as.integer(activityMod[, steps])
dailySubsetMod <- activityMod[, sum(steps, na.rm = TRUE), by = date]
setnames(dailySubsetMod, 'V1', 'total_steps')
par(mfrow=c(1,2))
hist(dailySubset[,total_steps], breaks = 9, main = 'Histogram of daily total steps', xlab = '# of total steps', col = 'darkolivegreen4')
hist(dailySubsetMod[,total_steps], breaks = 9, main = 'Histogram of daily total steps 2', xlab = '# of total steps', col = 'darkolivegreen4')
```

The second histogram is broken because dailySubsetMod is not properly subset. This is unfinished. 